!function(){"use strict";var t=function(){function t(t,n){for(var s in n){var i=n[s];i.configurable=!0,i.value&&(i.writable=!0)}Object.defineProperties(t,n)}return function(n,s,i){return s&&t(n.prototype,s),i&&t(n,i),n}}(),n=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},s=function(){function s(){n(this,s),this.settings={}}return t(s,{credential:{value:function(t,n){return this.settings.login=t,this.settings.password=n,this}},url:{value:function(t){var n=function(){return t.apply(this,arguments)};return n.toString=function(){return t.toString()},n}(function(t){return this.settings.url=t,this})},"class":{value:function(t){return this.settings["class"]=t,this}},settings:{value:function(t){return this.settings=t,this}},debug:{value:function(t){return this.settings.debug=t,this}},vhost:{value:function(t){return this.settings.vhost=t,this}},$get:{value:function(t,n,s){return new i(this.settings,t,n,s)}}}),s}(),i=function(){function s(t,i,e,o){n(this,s),this.settings=t,this.$q=i,this.$rootScope=o,this.stompClient=t["class"]?Stomp.over(new t["class"](t.url)):Stomp.client(t.url),this.stompClient.debug=t.debug?e.debug:function(){},this.connections=[],this.deferred=this.$q.defer(),this.promiseResult=this.deferred.promise,this.connect()}return t(s,{connect:{value:function(){var t=this;return this.stompClient.connect(this.settings.login,this.settings.password,function(){t.deferred.resolve(),t.$digestStompAction()},function(){t.deferred.reject(),t.$digestStompAction()},this.settings.vhost),this.promiseResult}},subscribe:{value:function(t,n,s){var i=this;return this.promiseResult.then(function(){i.$stompSubscribe(t,n),i.unRegisterScopeOnDestroy(s,t)}),this}},unsubscribe:{value:function(t){var n=this;return this.promiseResult.then(function(){return n.$stompUnSubscribe(t)}),this}},send:{value:function(t,n,s){var i=this,e=this.$q.defer();return this.promiseResult.then(function(){i.stompClient.send(t,s||{},JSON.stringify(n)),e.resolve()}),e.promise}},disconnect:{value:function(){var t=this,n=this.$q.defer();return this.stompClient.disconnect(function(){n.resolve(),t.$digestStompAction()}),n.promise}},$stompSubscribe:{value:function(t,n){var s=this,i=arguments,e=this.stompClient.subscribe(t,function(){n.apply(s.stompClient,i),s.$digestStompAction()});this.connections.push({url:t,subscription:e})}},$stompUnSubscribe:{value:function(t){for(var n=!1,s=0,i=this.connections.length;i>s;s++)if(this.connections[s].url===t){n=s,this.connections[s].subscription.unsubscribe();break}n!==!1&&this.connections.splice(n,1)}},$digestStompAction:{value:function(){!$rootScope.$$phase&&$rootScope.$apply()}},unRegisterScopeOnDestroy:{value:function(t,n){var s=this;void 0!==t&&angular.isFunction(t.$on)&&t.$on("$destroy",function(){return s.unsubscribe(n)})}}}),s}();angular.module("AngularStompDK",[]).provider("ngstomp",s)}();
//# sourceMappingURL=angular-stomp.min.js.map