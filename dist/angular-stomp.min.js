!function(){"use strict";angular.module("AngularStompDK",[]).factory("ngstompinternal",["$rootScope","$log",function(n,t){var i=function(n,i,s){this.stompClient=i?Stomp.over(new i(n)):Stomp.client(n),this.stompClient.debug=s?t.debug:function(){},this.connections=[]};return i.prototype.subscribe=function(t,i){var s=this.stompClient,o=s.subscribe(t,function(){i.apply(s,arguments),n.$$phase||n.$apply()});this.connections.push({url:t,subscription:o})},i.prototype.unsubscribe=function(n){for(var t=!1,i=0,s=this.connections.length;s>i;i++)this.connections[i].url===n&&(t=i,this.connections[i].subscription.unsubscribe());t!==!1&&this.connections.splice(t,1)},i.prototype.send=function(n,t,i){this.stompClient.send(n,t,i)},i.prototype.connect=function(t,i,s,o,e){var c=this;this.stompClient.connect(t,i,function(){s.apply(c.stompClient,arguments),n.$$phase||n.$apply()},function(){o.apply(c.stompClient,arguments),n.$$phase||n.$apply()},e)},i.prototype.disconnect=function(t){var i=this;this.stompClient.disconnect(function(){t.apply(i.stompClient,arguments),n.$$phase||n.$apply()})},function(n,t,s){return new i(n,t,s)}}]).provider("ngstomp",function(){function n(n,t,i){var s=this,o=t(n.url,n.class),e=i.defer(),c=e.promise;s.connect=function(){return o.connect(n.login,n.password,function(){s.isConnected=!0,e.resolve()}),c},s.subscribe=function(n,t,i){return c.then(function(){o.subscribe(n,t),void 0!==i&&angular.isFunction(i.$on)&&i.$on("$destroy",function(){s.unsubscribe(n)})}),s},s.unsubscribe=function(n,t){return c.then(function(){o.unsubscribe(n,t)}),s},s.send=function(n,t,s){var e=i.defer();return c.then(function(){o.send(n,s||{},JSON.stringify(t)),e.resolve()}),e.promise},s.connect()}var t={};this.credential=function(n,i){return t.login=n,t.password=i,this},this.url=function(n){return t.url=n,this},this.class=function(n){return t.class=n,this},this.settings=function(n){return t=n,this},this.$get=["ngstompinternal","$q",function(i,s){return new n(t,i,s)}]})}();